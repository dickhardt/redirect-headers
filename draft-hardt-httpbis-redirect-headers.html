<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>HTTP Redirect Headers</title>
<meta content="Dick Hardt" name="author">
<meta content="Sam Goto" name="author">
<meta content="
       This document defines HTTP headers that enable secure parameter passing and mutual authentication during browser redirects. The Redirect-Query header carries parameters in browser-controlled headers instead of URLs, preventing leakage through browser history, Referer headers, server logs, and analytics systems. The Redirect-Origin header provides browser-verified origin authentication that cannot be spoofed or stripped, enabling reliable mutual authentication between parties. The optional Redirect-Path header allows servers to request path-specific origin verification. Together, these headers address critical security and privacy concerns in authentication and authorization protocols such as OAuth 2.0 and OpenID Connect. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="http" name="keyword">
<meta content="redirect" name="keyword">
<meta content="oauth" name="keyword">
<meta content="security" name="keyword">
<meta content="privacy" name="keyword">
<meta content="draft-hardt-httpbis-redirect-headers-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.5.0
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.5
    wcwidth 0.2.14
-->
<link href="draft-hardt-httpbis-redirect-headers.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Redirect Headers</td>
<td class="right">December 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hardt &amp; Goto</td>
<td class="center">Expires 18 June 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">HTTP</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-hardt-httpbis-redirect-headers-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-12-15" class="published">15 December 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-06-18">18 June 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Hardt</div>
<div class="org">Hellō</div>
</div>
<div class="author">
      <div class="author-name">S. Goto</div>
<div class="org">Google</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">HTTP Redirect Headers</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines HTTP headers that enable secure parameter passing and mutual authentication during browser redirects. The Redirect-Query header carries parameters in browser-controlled headers instead of URLs, preventing leakage through browser history, Referer headers, server logs, and analytics systems. The Redirect-Origin header provides browser-verified origin authentication that cannot be spoofed or stripped, enabling reliable mutual authentication between parties. The optional Redirect-Path header allows servers to request path-specific origin verification. Together, these headers address critical security and privacy concerns in authentication and authorization protocols such as OAuth 2.0 and OpenID Connect.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 18 June 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-redirect-headers" class="internal xref">Redirect Headers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-redirect-query" class="internal xref">Redirect-Query</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-redirect-origin" class="internal xref">Redirect-Origin</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1" class="keepWithNext"><a href="#section-2.2.1" class="auto internal xref">2.2.1</a>.  <a href="#name-example-1-origin-only-verif" class="internal xref">Example 1: Origin-only verification (without Redirect-Path)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a href="#section-2.2.2" class="auto internal xref">2.2.2</a>.  <a href="#name-example-2-originpath-verifi" class="internal xref">Example 2: Origin+path verification (with Redirect-Path)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-redirect-path" class="internal xref">Redirect-Path</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-feature-discovery" class="internal xref">Feature Discovery</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-oauth-redirect-security-thr" class="internal xref">OAuth Redirect Security Threats</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-authorization-code-theft-fr" class="internal xref">Authorization Code Theft from URL Query Strings</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-oauth-incremental-deploymen" class="internal xref">OAuth Incremental Deployment</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-how-it-works" class="internal xref">How It Works</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-adoption-path" class="internal xref">Adoption Path</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-header-confidentiality" class="internal xref">Header Confidentiality</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-browser-implementation-requ" class="internal xref">Browser Implementation Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-origin-verification-limits" class="internal xref">Origin Verification Limits</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-browser-trust-model" class="internal xref">Browser Trust Model</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-transition-period-risks" class="internal xref">Transition Period Risks</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-url-history-and-referer-lea" class="internal xref">URL History and Referer Leakage</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-network-observer-privacy" class="internal xref">Network Observer Privacy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-redirect-origin-privacy-imp" class="internal xref">Redirect-Origin Privacy Implications</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-user-control-and-transparen" class="internal xref">User Control and Transparency</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-server-logging-practices" class="internal xref">Server Logging Practices</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-redirect-query-header-field" class="internal xref">Redirect-Query Header Field</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-redirect-origin-header-fiel" class="internal xref">Redirect-Origin Header Field</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-redirect-path-header-field" class="internal xref">Redirect-Path Header Field</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-redirect-supported-header-f" class="internal xref">Redirect-Supported Header Field</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-implementation-status" class="internal xref">Implementation Status</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-oauth-example-before-and-af" class="internal xref">OAuth Example: Before and After</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-without-redirect-headers-cu" class="internal xref">Without Redirect Headers (current OAuth)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-with-redirect-headers" class="internal xref">With Redirect Headers</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Authentication and authorization protocols (OAuth <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, OpenID Connect <span>[<a href="#OIDC" class="cite xref">OIDC</a>]</span>, SAML) use browser redirects to navigate users between applications and authorization servers. These redirects must carry protocol parameters, which historically appear in URLs or POSTed forms.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document addresses two distinct problems in redirect-based protocols:<a href="#section-1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1-3">
<li id="section-1-3.1">
          <p id="section-1-3.1.1"><strong>Parameter Leakage</strong>: URL parameters leak sensitive data (authorization codes, tokens, session identifiers) through browser history, Referer headers, server logs, analytics systems, and JavaScript access. POST-based redirects expose parameters in DOM form fields. Both mechanisms make sensitive data visible to unintended parties.<a href="#section-1-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-1-3.2">
          <p id="section-1-3.2.1"><strong>Origin Verification</strong>: Current mechanisms for verifying the origin of redirects are unreliable. The Referer header may be stripped, rewritten, or removed by privacy tools and enterprise proxies, preventing reliable mutual authentication between parties.<a href="#section-1-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-1-4">This document defines two HTTP headers that address these problems:<a href="#section-1-4" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-1-5.1">
          <strong>Redirect-Query</strong> - Carries parameters in a browser-controlled header instead of URLs, preventing leakage while always being paired with origin verification<a href="#section-1-5.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-1-5.2">
          <strong>Redirect-Origin</strong> - Provides browser-verified origin authentication that cannot be spoofed by scripts or manipulated by intermediaries<a href="#section-1-5.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-6">A third header, <strong>Redirect-Path</strong>, allows servers to request path-specific origin verification when finer-grained validation is needed.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7"><strong>Note on independent use</strong>: While origin verification without parameter passing is theoretically possible (server sends Redirect-Path, browser responds with Redirect-Origin), no specific use cases have been identified for this configuration.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8"><strong>Incremental Deployment:</strong> A key feature of this specification is that deployment does not require coordination between parties. Each party (client application, browser, authorization server) can independently add support for Redirect Headers. Full functionality emerges naturally when all three parties support the mechanism, but partial deployment gracefully degrades to existing URL-based behavior. This allows for organic adoption without requiring synchronized upgrades across the ecosystem.<a href="#section-1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="redirect-headers">
<section id="section-2">
      <h2 id="name-redirect-headers">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-redirect-headers" class="section-name selfRef">Redirect Headers</a>
      </h2>
<p id="section-2-1">Three headers work together during top-level 303 (See Other) redirects to provide secure parameter passing and mutual authentication:<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2"><strong>Redirect-Query</strong> carries parameters from servers (client applications or authorization servers) to the browser, which then forwards them to the next party. This keeps sensitive data out of URLs while maintaining the redirect flow.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3"><strong>Redirect-Origin</strong> provides browser-verified origin authentication. The browser sets this header when forwarding redirect parameters, allowing the receiving party to verify where the redirect originated. This cannot be spoofed by scripts or stripped by intermediaries.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4"><strong>Redirect-Path</strong> (optional) allows servers to request path-specific origin verification for finer-grained validation within an origin.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5"><strong>Browser behavior:</strong> Only processes these headers during top-level redirects. Ignores them for normal requests or embedded resources.<a href="#section-2-5" class="pilcrow">¶</a></p>
<div id="redirect-query">
<section id="section-2.1">
        <h3 id="name-redirect-query">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-redirect-query" class="section-name selfRef">Redirect-Query</a>
        </h3>
<p id="section-2.1-1">The Redirect-Query header carries redirect parameters using URL query string encoding. It is set by servers (either the client application or authorization server) in redirect responses.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1-2">
<pre>Redirect-Query: "code=SplxlOBe&amp;state=123"

</pre><a href="#section-2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-2.1-3"><strong>Properties:</strong><a href="#section-2.1-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-2.1-4.1">Set by server in HTTP 303 (See Other) redirect response<a href="#section-2.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-2.1-4.2">Replaces URL query parameters<a href="#section-2.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-2.1-4.3">Parsed using standard URL query string parsing<a href="#section-2.1-4.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-2.1-4.4">Prevents exposure via browser history, Referer, logs, and analytics<a href="#section-2.1-4.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-2.1-4.5">When present, browser MUST include Redirect-Origin in the subsequent request<a href="#section-2.1-4.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="redirect-origin">
<section id="section-2.2">
        <h3 id="name-redirect-origin">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-redirect-origin" class="section-name selfRef">Redirect-Origin</a>
        </h3>
<p id="section-2.2-1">The Redirect-Origin header provides browser-verified origin authentication. It is set ONLY by the browser and contains the origin (and optionally path) of the page from which the redirect originated.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2"><strong>Format:</strong> Always ends with <code>/</code><a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3"><strong>Properties:</strong><a href="#section-2.2-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-2.2-4.1">Set ONLY by the browser (cannot be spoofed by scripts or intermediaries)<a href="#section-2.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-2.2-4.2">Enables receiving party to verify the origin of the redirect<a href="#section-2.2-4.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-2.2-4.3">Provides mutual authentication between parties<a href="#section-2.2-4.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-2.2-4.4">Always ends with <code>/</code> for consistent parsing<a href="#section-2.2-4.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-2.2-4.5">May include validated path when Redirect-Path is used<a href="#section-2.2-4.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.2-5"><strong>Browser behavior:</strong><a href="#section-2.2-5" class="pilcrow">¶</a></p>
<p id="section-2.2-6">The browser sets Redirect-Origin when either Redirect-Query or Redirect-Path is present in the redirect response.<a href="#section-2.2-6" class="pilcrow">¶</a></p>
<div id="example-1-origin-only-verification-without-redirect-path">
<section id="section-2.2.1">
          <h4 id="name-example-1-origin-only-verif">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-example-1-origin-only-verif" class="section-name selfRef">Example 1: Origin-only verification (without Redirect-Path)</a>
          </h4>
<p id="section-2.2.1-1"><strong>Current page:</strong> <code>https://app.example/some/page</code><a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.2.1-2"><strong>Server sends redirect:</strong><a href="#section-2.2.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.1-3">
<pre>HTTP/1.1 303 See Other
Location: https://as.example/authorize
Redirect-Query: "client_id=abc&amp;state=123"

</pre><a href="#section-2.2.1-3" class="pilcrow">¶</a>
</div>
<p id="section-2.2.1-4"><strong>Browser forwards to AS:</strong><a href="#section-2.2.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.1-5">
<pre>GET /authorize
Host: as.example
Redirect-Origin: "https://app.example/"
Redirect-Query: "client_id=abc&amp;state=123"

</pre><a href="#section-2.2.1-5" class="pilcrow">¶</a>
</div>
<p id="section-2.2.1-6">The Redirect-Origin is set to the origin plus <code>/</code>, without any path component.<a href="#section-2.2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-2-origin-path-verification-with-redirect-path">
<section id="section-2.2.2">
          <h4 id="name-example-2-originpath-verifi">
<a href="#section-2.2.2" class="section-number selfRef">2.2.2. </a><a href="#name-example-2-originpath-verifi" class="section-name selfRef">Example 2: Origin+path verification (with Redirect-Path)</a>
          </h4>
<p id="section-2.2.2-1"><strong>Current page:</strong> <code>https://app.example/app1/some/page</code><a href="#section-2.2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2.2-2"><strong>Server sends redirect:</strong><a href="#section-2.2.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.2-3">
<pre>HTTP/1.1 303 See Other
Location: https://as.example/authorize
Redirect-Query: "client_id=abc&amp;state=123"
Redirect-Path: "/app1/"

</pre><a href="#section-2.2.2-3" class="pilcrow">¶</a>
</div>
<p id="section-2.2.2-4"><strong>Browser validates path claim:</strong>
- Redirect-Path claim: <code>/app1/</code>
- Current page path: <code>/app1/some/page</code>
- Validation: Does <code>/app1/some/page</code> start with <code>/app1/</code>? ✓ YES<a href="#section-2.2.2-4" class="pilcrow">¶</a></p>
<p id="section-2.2.2-5"><strong>Browser forwards to AS:</strong><a href="#section-2.2.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.2-6">
<pre>GET /authorize
Host: as.example
Redirect-Origin: "https://app.example/app1/"
Redirect-Query: "client_id=abc&amp;state=123"

</pre><a href="#section-2.2.2-6" class="pilcrow">¶</a>
</div>
<p id="section-2.2.2-7">The Redirect-Origin includes the validated path <code>/app1/</code> because the browser confirmed the current page is within that path.<a href="#section-2.2.2-7" class="pilcrow">¶</a></p>
<p id="section-2.2.2-8"><strong>If path validation fails:</strong><a href="#section-2.2.2-8" class="pilcrow">¶</a></p>
<p id="section-2.2.2-9">If the current page was <code>https://app.example/app2/page</code> and the server claimed <code>Redirect-Path: "/app1/"</code>, the browser would reject the path claim and send only the origin:<a href="#section-2.2.2-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.2-10">
<pre>Redirect-Origin: "https://app.example/"

</pre><a href="#section-2.2.2-10" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="redirect-path">
<section id="section-2.3">
        <h3 id="name-redirect-path">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-redirect-path" class="section-name selfRef">Redirect-Path</a>
        </h3>
<p id="section-2.3-1">The Redirect-Path header allows a server to request path-specific origin verification. It is set by the server in the redirect response as a claim about the current page's path. The browser validates this claim and, if valid, includes the path in Redirect-Origin.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2"><strong>Format:</strong> Must start and end with <code>/</code><a href="#section-2.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3-3">
<pre>Redirect-Path: "/app1/"

</pre><a href="#section-2.3-3" class="pilcrow">¶</a>
</div>
<p id="section-2.3-4"><strong>Server behavior:</strong><a href="#section-2.3-4" class="pilcrow">¶</a></p>
<p id="section-2.3-5">The server includes Redirect-Path in the redirect response when it wants the receiving party to know not just the origin, but also a specific path within that origin.<a href="#section-2.3-5" class="pilcrow">¶</a></p>
<p id="section-2.3-6"><strong>Browser validation:</strong><a href="#section-2.3-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-2.3-7">
<li id="section-2.3-7.1">Server sends: <code>Redirect-Path: "/app1/"</code><a href="#section-2.3-7.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.3-7.2">Browser checks: Does the current page path start with <code>/app1/</code>?<a href="#section-2.3-7.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.3-7.3">If valid: Include path in <code>Redirect-Origin: "https://example.com/app1/"</code><a href="#section-2.3-7.3" class="pilcrow">¶</a>
</li>
          <li id="section-2.3-7.4">If invalid: Ignore the path claim, use origin only: <code>Redirect-Origin: "https://example.com/"</code><a href="#section-2.3-7.4" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-2.3-8">This mechanism prevents path manipulation attacks where an attacker might try to redirect from an unexpected path within the same origin. The server cannot lie about its path because the browser enforces validation.<a href="#section-2.3-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="feature-discovery">
<section id="section-3">
      <h2 id="name-feature-discovery">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-feature-discovery" class="section-name selfRef">Feature Discovery</a>
      </h2>
<p id="section-3-1">Some protocols may wish to discover browser support for Redirect Headers using Client Hints <span>[<a href="#RFC8942" class="cite xref">RFC8942</a>]</span>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2"><strong>Server advertises support:</strong><a href="#section-3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3-3">
<pre>Accept-CH: Redirect-Supported

</pre><a href="#section-3-3" class="pilcrow">¶</a>
</div>
<p id="section-3-4"><strong>Browser responds with capability:</strong><a href="#section-3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3-5">
<pre>Redirect-Supported: ?1

</pre><a href="#section-3-5" class="pilcrow">¶</a>
</div>
<p id="section-3-6"><strong>Note:</strong> Feature discovery is optional and not required for OAuth flows. The incremental deployment model works without explicit discovery - authorization servers detect support by receiving Redirect-Query headers in requests.<a href="#section-3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oauth-redirect-security-threats">
<section id="section-4">
      <h2 id="name-oauth-redirect-security-thr">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-oauth-redirect-security-thr" class="section-name selfRef">OAuth Redirect Security Threats</a>
      </h2>
<p id="section-4-1"><strong>Scope:</strong> Redirect Headers specifically addresses OAuth and OIDC web-based redirect flows between websites where sensitive parameters are passed via URL query strings. This proposal does NOT address form_post mechanisms where data appears in the DOM, as that attack vector requires different mitigations.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="authorization-code-theft-from-url-query-strings">
<section id="section-4.1">
        <h3 id="name-authorization-code-theft-fr">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-authorization-code-theft-fr" class="section-name selfRef">Authorization Code Theft from URL Query Strings</a>
        </h3>
<p id="section-4.1-1">The primary security weakness is in the <strong>authorization server's response</strong> containing the authorization code in the URL query string. When an AS redirects back to the client with ?code=...&amp;state=..., the authorization code is exposed through multiple vectors:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2"><strong>Known attack vectors:</strong><a href="#section-4.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1-3">
<li id="section-4.1-3.1">
            <p id="section-4.1-3.1.1"><strong>Browser history leakage</strong> - Authorization codes stored in browser history can be retrieved by attackers with device access<a href="#section-4.1-3.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1-3.1.2.1">Reference: OAuth 2.0 Security Best Current Practice <span>[<a href="#OAUTH-SECURITY-TOPICS" class="cite xref">OAUTH-SECURITY-TOPICS</a>]</span><a href="#section-4.1-3.1.2.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-4.1-3.2">
            <p id="section-4.1-3.2.1"><strong>Server log exposure</strong> - Authorization codes visible in web server access logs, proxy logs, and load balancer logs<a href="#section-4.1-3.2.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1-3.2.2.1">Codes can be extracted in real-time or from archived logs<a href="#section-4.1-3.2.2.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-4.1-3.3">
            <p id="section-4.1-3.3.1"><strong>Referer header leakage</strong> - When the callback page loads third-party resources (images, scripts, analytics), the authorization code leaks via the Referer header<a href="#section-4.1-3.3.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1-3.3.2.1">Reference: OAuth 2.0 authentication vulnerabilities <span>[<a href="#PORTSWIGGER-OAUTH" class="cite xref">PORTSWIGGER-OAUTH</a>]</span><a href="#section-4.1-3.3.2.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-4.1-3.4">
            <p id="section-4.1-3.4.1"><strong>Browser-swapping attacks</strong> - Attackers exploit scenarios where authorization codes leak through shared URLs or when users switch browsers during the flow<a href="#section-4.1-3.4.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1-3.4.2.1">Discussion: OAuth-WG Browser-Swapping thread<a href="#section-4.1-3.4.2.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-4.1-3.5">
            <p id="section-4.1-3.5.1"><strong>URL sharing</strong> - Users may inadvertently share URLs containing authorization codes after errors or confusion<a href="#section-4.1-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-3.6">
            <p id="section-4.1-3.6.1"><strong>Analytics and crash reporting</strong> - Authorization codes captured by analytics systems, error tracking, and monitoring tools<a href="#section-4.1-3.6.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-4.1-4"><strong>What Redirect Headers mitigates:</strong><a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">By moving the authorization code from the URL query string to the Redirect-Query header, <strong>all of these attack vectors are eliminated</strong>. The authorization code never appears in:<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1-6.1">URLs (no browser history exposure)<a href="#section-4.1-6.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.1-6.2">Referer headers (no leakage to third parties)<a href="#section-4.1-6.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.1-6.3">Server logs (when servers are configured to not log sensitive headers)<a href="#section-4.1-6.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.1-6.4">User-visible locations (no accidental sharing)<a href="#section-4.1-6.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.1-7"><strong>Important clarification:</strong><a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">The security concern is specifically the <strong>authorization server's response</strong> with the authorization code. The <strong>client's authorization request</strong> to the AS (containing client_id, redirect_uri, state) does not have known security concerns from being in the URL, as these parameters are not sensitive credentials. However, moving them to headers provides consistency and reduces URL clutter.<a href="#section-4.1-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="oauth-incremental-deployment">
<section id="section-5">
      <h2 id="name-oauth-incremental-deploymen">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-oauth-incremental-deploymen" class="section-name selfRef">OAuth Incremental Deployment</a>
      </h2>
<p id="section-5-1">Redirect Headers is designed for <strong>incremental adoption</strong> - each party (client, browser, authorization server) can independently add support, with functionality emerging when all parties support it.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="how-it-works">
<section id="section-5.1">
        <h3 id="name-how-it-works">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-how-it-works" class="section-name selfRef">How It Works</a>
        </h3>
<p id="section-5.1-1"><strong>Clients</strong> can start sending parameters in both locations:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.1-2.1">URL query string (for backward compatibility)<a href="#section-5.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-5.1-2.2">Redirect-Query header (signaling support)<a href="#section-5.1-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-3"><strong>Browsers</strong> forward Redirect- headers when present:<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.1-4.1">No special detection needed<a href="#section-5.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-5.1-4.2">Simply forward the headers during redirects<a href="#section-5.1-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-5"><strong>Authorization Servers</strong> detect support and respond accordingly:<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.1-6.1">If request includes Redirect-Query → AS knows both client and browser support it<a href="#section-5.1-6.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-5.1-6.2">AS can then send response using <strong>only</strong> Redirect-Query header (no URL parameters)<a href="#section-5.1-6.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="adoption-path">
<section id="section-5.2">
        <h3 id="name-adoption-path">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-adoption-path" class="section-name selfRef">Adoption Path</a>
        </h3>
<p id="section-5.2-1">Each party adds support independently, in any order:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-2">
<pre>Clients add support
  ├─ Send params in URL + Redirect-Query
  └─ Look for response in header, fall back to URL

Browsers add support
  ├─ Forward Redirect-* headers when present
  └─ No configuration needed

Authorization Servers add support
  ├─ Detect support when Redirect-Query received
  ├─ Confirm: client + browser both support it
  └─ Send response ONLY in Redirect-Query (omit URL params)

Result: Once all three support it → authorization code sent in header, not URL

</pre><a href="#section-5.2-2" class="pilcrow">¶</a>
</div>
<p id="section-5.2-3"><strong>No coordination required</strong> - each party adds support independently, and the system naturally converges to the secure behavior once all three support it. The client can immediately start sending both, browsers simply forward headers, and authorization servers detect support from incoming requests.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="header-confidentiality">
<section id="section-6.1">
        <h3 id="name-header-confidentiality">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-header-confidentiality" class="section-name selfRef">Header Confidentiality</a>
        </h3>
<p id="section-6.1-1">Redirect-Query carries sensitive parameters (authorization codes, tokens, session identifiers) that MUST be protected with the same care as credentials. Servers MUST:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.1-2.1">Configure logging systems to exclude or redact Redirect-Query header values<a href="#section-6.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.1-2.2">Treat Redirect-Query with the same confidentiality as Authorization headers<a href="#section-6.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.1-2.3">Use TLS for all redirects carrying Redirect-Query to prevent network observation<a href="#section-6.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.1-3">Network intermediaries (proxies, load balancers, CDNs) can observe header values in transit. Deployment environments with untrusted intermediaries require additional protection beyond this specification.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="browser-implementation-requirements">
<section id="section-6.2">
        <h3 id="name-browser-implementation-requ">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-browser-implementation-requ" class="section-name selfRef">Browser Implementation Requirements</a>
        </h3>
<p id="section-6.2-1">Browsers MUST enforce strict isolation of Redirect headers:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.2-2.1">JavaScript MUST NOT be able to read or set Redirect-* headers via any API<a href="#section-6.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.2-2.2">Browser extensions MUST NOT have access to Redirect-* headers<a href="#section-6.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.2-2.3">Only the browser's redirect handling mechanism can create or consume these headers<a href="#section-6.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.2-2.4">Headers MUST only be processed during top-level navigation redirects, never for subresource requests<a href="#section-6.2-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.2-3">Failure to enforce these restrictions would allow malicious scripts to forge origin claims or steal sensitive parameters.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="origin-verification-limits">
<section id="section-6.3">
        <h3 id="name-origin-verification-limits">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-origin-verification-limits" class="section-name selfRef">Origin Verification Limits</a>
        </h3>
<p id="section-6.3-1">Redirect-Origin provides browser-mediated mutual authentication but has limitations:<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.3-2.1">It verifies the browser's understanding of origin, not the server's identity<a href="#section-6.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.3-2.2">It does not authenticate the user or establish a secure channel<a href="#section-6.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.3-2.3">It supplements but does NOT replace redirect_uri validation and registration<a href="#section-6.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.3-2.4">Servers MUST continue to validate redirect_uri against registered values<a href="#section-6.3-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.3-3">Redirect-Path provides additional validation within an origin but cannot prevent attacks where the attacker controls a legitimate path within the same origin.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="browser-trust-model">
<section id="section-6.4">
        <h3 id="name-browser-trust-model">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-browser-trust-model" class="section-name selfRef">Browser Trust Model</a>
        </h3>
<p id="section-6.4-1">This specification assumes an honest browser implementation. It cannot protect against:<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.4-2.1">Compromised or malicious browsers<a href="#section-6.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.4-2.2">Browser bugs that fail to enforce header restrictions<a href="#section-6.4-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.4-2.3">Browser extensions with elevated privileges<a href="#section-6.4-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.4-2.4">Debugging tools that modify headers<a href="#section-6.4-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.4-3">Servers should monitor for anomalous behavior (e.g., Redirect-Origin values that don't match expected patterns) as potential indicators of browser compromise or implementation bugs.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="transition-period-risks">
<section id="section-6.5">
        <h3 id="name-transition-period-risks">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-transition-period-risks" class="section-name selfRef">Transition Period Risks</a>
        </h3>
<p id="section-6.5-1">During incremental deployment, clients may send parameters in both URL and headers for backward compatibility. This dual-sending pattern preserves URL leakage risks until:<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.5-2.1">All parties (client, browser, server) support Redirect Headers<a href="#section-6.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.5-2.2">Clients stop including parameters in URLs<a href="#section-6.5-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.5-3">Servers SHOULD detect Redirect-Query presence and warn or reject requests that also include sensitive parameters in URLs, to encourage migration away from URL-based parameters.<a href="#section-6.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-7">
      <h2 id="name-privacy-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<div id="url-history-and-referer-leakage">
<section id="section-7.1">
        <h3 id="name-url-history-and-referer-lea">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-url-history-and-referer-lea" class="section-name selfRef">URL History and Referer Leakage</a>
        </h3>
<p id="section-7.1-1">When parameters remain in URLs (as during transition or with non-supporting implementations), sensitive data persists in browser history and may leak via Referer headers. Implementers should consider:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-7.1-2.1">Browser history is persistent storage that may be accessed by malware, forensic tools, or unauthorized users with device access<a href="#section-7.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-7.1-2.2">Referer headers are sent automatically to third-party resources, potentially leaking parameters to analytics providers, CDNs, or advertisers<a href="#section-7.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-7.1-2.3">The transition to headers does not eliminate these risks until all parties stop sending parameters in URLs<a href="#section-7.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.1-3">This specification does not eliminate all tracking vectors - cookies, browser fingerprinting, and other mechanisms remain unaffected.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="network-observer-privacy">
<section id="section-7.2">
        <h3 id="name-network-observer-privacy">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-network-observer-privacy" class="section-name selfRef">Network Observer Privacy</a>
        </h3>
<p id="section-7.2-1">Network intermediaries can still observe Redirect-* headers in transit, just as they can observe URL parameters today. This specification does not enhance privacy against network-level observers (ISPs, proxies, corporate firewalls). TLS remains essential for protecting parameters from network observation.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">In some cases, moving parameters to headers may slightly improve privacy: unlike URL paths (which may be visible in TLS SNI or DNS queries), HTTP headers are encrypted by TLS and not visible to passive network observers.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="redirect-origin-privacy-implications">
<section id="section-7.3">
        <h3 id="name-redirect-origin-privacy-imp">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-redirect-origin-privacy-imp" class="section-name selfRef">Redirect-Origin Privacy Implications</a>
        </h3>
<p id="section-7.3-1">Redirect-Origin explicitly reveals the origin (and optionally path) of the redirecting page. Implementers should consider:<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-7.3-2.1">This is similar to the Referer header but more reliable and always present when Redirect-Query is used<a href="#section-7.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-7.3-2.2">It enables the receiving party to know definitively where the redirect originated<a href="#section-7.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-7.3-2.3">Unlike Referer (which users/tools can strip for privacy), Redirect-Origin cannot be disabled by the user when Redirect-Query is present<a href="#section-7.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-7.3-2.4">This trade-off prioritizes security (mutual authentication) over origin hiding<a href="#section-7.3-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.3-3">Protocols using Redirect Headers should only be deployed where mutual knowledge of party identities is acceptable and expected (as in OAuth, where the AS and client already know each other).<a href="#section-7.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="user-control-and-transparency">
<section id="section-7.4">
        <h3 id="name-user-control-and-transparen">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-user-control-and-transparen" class="section-name selfRef">User Control and Transparency</a>
        </h3>
<p id="section-7.4-1">Users have limited control over Redirect Headers:<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-7.4-2.1">Users cannot inspect or modify Redirect-* headers (unlike URL parameters which are visible)<a href="#section-7.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-7.4-2.2">Users cannot selectively disable Redirect-Origin without breaking functionality<a href="#section-7.4-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-7.4-2.3">Browser developer tools may or may not expose these headers depending on implementation<a href="#section-7.4-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.4-3">Browser implementations SHOULD provide visibility into Redirect Headers in developer tools for transparency, while maintaining the security restriction that JavaScript cannot access them.<a href="#section-7.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-logging-practices">
<section id="section-7.5">
        <h3 id="name-server-logging-practices">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-server-logging-practices" class="section-name selfRef">Server Logging Practices</a>
        </h3>
<p id="section-7.5-1">While Redirect Headers remove parameters from URLs (reducing accidental logging via URL-based logs), servers must implement appropriate logging controls:<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-7.5-2.1">Configure web servers and load balancers to exclude Redirect-Query from access logs<a href="#section-7.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-7.5-2.2">Ensure application logging redacts sensitive header values<a href="#section-7.5-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-7.5-2.3">Be aware that default logging configurations may capture all headers<a href="#section-7.5-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.5-3">The shift to headers does not automatically prevent logging - it requires conscious configuration changes.<a href="#section-7.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document registers four new HTTP header fields in the "Hypertext Transfer Protocol (HTTP) Field Name Registry" defined in <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="redirect-query-header-field">
<section id="section-8.1">
        <h3 id="name-redirect-query-header-field">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-redirect-query-header-field" class="section-name selfRef">Redirect-Query Header Field</a>
        </h3>
<p id="section-8.1-1">Header field name: Redirect-Query<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">Applicable protocol: http<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">Status: standard<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1-4">Author/Change controller: IETF<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<p id="section-8.1-5">Specification document(s): [this document]<a href="#section-8.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="redirect-origin-header-field">
<section id="section-8.2">
        <h3 id="name-redirect-origin-header-fiel">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-redirect-origin-header-fiel" class="section-name selfRef">Redirect-Origin Header Field</a>
        </h3>
<p id="section-8.2-1">Header field name: Redirect-Origin<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">Applicable protocol: http<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">Status: standard<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4">Author/Change controller: IETF<a href="#section-8.2-4" class="pilcrow">¶</a></p>
<p id="section-8.2-5">Specification document(s): [this document]<a href="#section-8.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="redirect-path-header-field">
<section id="section-8.3">
        <h3 id="name-redirect-path-header-field">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-redirect-path-header-field" class="section-name selfRef">Redirect-Path Header Field</a>
        </h3>
<p id="section-8.3-1">Header field name: Redirect-Path<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">Applicable protocol: http<a href="#section-8.3-2" class="pilcrow">¶</a></p>
<p id="section-8.3-3">Status: standard<a href="#section-8.3-3" class="pilcrow">¶</a></p>
<p id="section-8.3-4">Author/Change controller: IETF<a href="#section-8.3-4" class="pilcrow">¶</a></p>
<p id="section-8.3-5">Specification document(s): [this document]<a href="#section-8.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="redirect-supported-header-field">
<section id="section-8.4">
        <h3 id="name-redirect-supported-header-f">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-redirect-supported-header-f" class="section-name selfRef">Redirect-Supported Header Field</a>
        </h3>
<p id="section-8.4-1">Header field name: Redirect-Supported<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4-2">Applicable protocol: http<a href="#section-8.4-2" class="pilcrow">¶</a></p>
<p id="section-8.4-3">Status: standard<a href="#section-8.4-3" class="pilcrow">¶</a></p>
<p id="section-8.4-4">Author/Change controller: IETF<a href="#section-8.4-4" class="pilcrow">¶</a></p>
<p id="section-8.4-5">Specification document(s): [this document]<a href="#section-8.4-5" class="pilcrow">¶</a></p>
<p id="section-8.4-6">Comments: Client Hint for feature discovery<a href="#section-8.4-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="implementation-status">
<section id="section-9">
      <h2 id="name-implementation-status">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="section-9-1"><strong>Note to RFC Editor:</strong> Please remove this section before publication.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2"><strong>Specification status:</strong> Exploratory draft<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3"><strong>Browser support:</strong> Not yet implemented (proposed specification)<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4"><strong>Server support:</strong> Reference implementations needed<a href="#section-9-4" class="pilcrow">¶</a></p>
<p id="section-9-5">This specification requires:<a href="#section-9-5" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-9-6.1">Browser vendors to implement header handling<a href="#section-9-6.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-9-6.2">Authorization servers to support Redirect-Query<a href="#section-9-6.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-9-6.3">Client applications to adopt the pattern<a href="#section-9-6.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-9-7">Deployment strategy: Backward compatible - clients send both URL and headers during transition.<a href="#section-9-7" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8942">[RFC8942]</dt>
        <dd>
<span class="refAuthor">Grigorik, I.</span> and <span class="refAuthor">Y. Weiss</span>, <span class="refTitle">"HTTP Client Hints"</span>, <span class="seriesInfo">RFC 8942</span>, <span class="seriesInfo">DOI 10.17487/RFC8942</span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8942">https://www.rfc-editor.org/info/rfc8942</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9110">[RFC9110]</dt>
      <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC 9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9110">https://www.rfc-editor.org/info/rfc9110</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="OAUTH-SECURITY-TOPICS">[OAUTH-SECURITY-TOPICS]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T., Ed.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Labunets, A.</span>, and <span class="refAuthor">D. Fett</span>, <span class="refTitle">"OAuth 2.0 Security Best Current Practice"</span>, <time datetime="2024-10" class="refDate">October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OIDC">[OIDC]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.</span>, <span class="refAuthor">de Medeiros, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"OpenID Connect Core 1.0"</span>, <time datetime="2014-11" class="refDate">November 2014</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-core-1_0.html">https://openid.net/specs/openid-connect-core-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PORTSWIGGER-OAUTH">[PORTSWIGGER-OAUTH]</dt>
      <dd>
<span class="refAuthor">PortSwigger</span>, <span class="refTitle">"OAuth 2.0 authentication vulnerabilities"</span>, <time datetime="2024" class="refDate">2024</time>, <span>&lt;<a href="https://portswigger.net/web-security/oauth">https://portswigger.net/web-security/oauth</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="oauth-example-before-and-after">
<section id="appendix-A">
      <h2 id="name-oauth-example-before-and-af">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-oauth-example-before-and-af" class="section-name selfRef">OAuth Example: Before and After</a>
      </h2>
<p id="appendix-A-1">This appendix provides a detailed comparison of OAuth flows with and without Redirect Headers to illustrate the differences in security and functionality.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="without-redirect-headers-current-oauth">
<section id="appendix-A.1">
        <h3 id="name-without-redirect-headers-cu">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-without-redirect-headers-cu" class="section-name selfRef">Without Redirect Headers (current OAuth)</a>
        </h3>
<p id="appendix-A.1-1"><strong>Client Website returns to Browser:</strong><a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-2">
<pre>HTTP/1.1 303 See Other
Location: https://as.example/authorize?client_id=abc&amp;state=123&amp;redirect_uri=...

</pre><a href="#appendix-A.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-3"><strong>Browser navigates, sends to AS:</strong><a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-4">
<pre>GET /authorize?client_id=abc&amp;state=123&amp;redirect_uri=...
Host: as.example
Referer: https://app.example/login

</pre><a href="#appendix-A.1-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-5">← Unreliable, may be stripped<a href="#appendix-A.1-5" class="pilcrow">¶</a></p>
<p id="appendix-A.1-6"><strong>AS returns code to Browser:</strong><a href="#appendix-A.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-7">
<pre>HTTP/1.1 303 See Other
Location: https://app.example/cb?code=SplxlOBe&amp;state=123

</pre><a href="#appendix-A.1-7" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-8">← Leaked in URL<a href="#appendix-A.1-8" class="pilcrow">¶</a></p>
<p id="appendix-A.1-9"><strong>Browser sends code to Client Website:</strong><a href="#appendix-A.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-10">
<pre>GET /cb?code=SplxlOBe&amp;state=123
Host: app.example
Referer: https://as.example/consent

</pre><a href="#appendix-A.1-10" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-11">← In browser history, logs, analytics
← Third-party resources see code via Referer<a href="#appendix-A.1-11" class="pilcrow">¶</a></p>
<p id="appendix-A.1-12"><strong>Problems:</strong><a href="#appendix-A.1-12" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-A.1-13.1">Authorization code appears in URL (history, logs, Referer, extensions)<a href="#appendix-A.1-13.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-A.1-13.2">No cryptographic origin verification (Referer is optional and unreliable)<a href="#appendix-A.1-13.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="with-redirect-headers">
<section id="appendix-A.2">
        <h3 id="name-with-redirect-headers">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-with-redirect-headers" class="section-name selfRef">With Redirect Headers</a>
        </h3>
<p id="appendix-A.2-1"><strong>Client Website returns to Browser:</strong><a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-2">
<pre>HTTP/1.1 303 See Other
Location: https://as.example/authorize
Redirect-Query: "client_id=abc&amp;state=123&amp;redirect_uri=https://app.example/app1/cb"
Redirect-Path: "/app1/"

</pre><a href="#appendix-A.2-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-3"><strong>Browser validates and adds origin:</strong>
- Current page: <code>https://app.example/app1/page</code>
- Redirect-Path claim: <code>/app1/</code> ✓ (page path starts with <code>/app1/</code>)
- Sets Redirect-Origin: <code>https://app.example/app1/</code><a href="#appendix-A.2-3" class="pilcrow">¶</a></p>
<p id="appendix-A.2-4"><strong>Browser navigates, sends to AS:</strong><a href="#appendix-A.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-5">
<pre>GET /authorize
Host: as.example
Redirect-Origin: "https://app.example/app1/"
Redirect-Query: "client_id=abc&amp;state=123&amp;redirect_uri=https://app.example/app1/cb"

</pre><a href="#appendix-A.2-5" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-6">← Browser-supplied origin+path, cannot be spoofed
← Parameters not in URL!<a href="#appendix-A.2-6" class="pilcrow">¶</a></p>
<p id="appendix-A.2-7"><strong>AS validates and returns to Browser:</strong>
- Verifies Redirect-Origin: <code>https://app.example/app1/</code>
- Verifies redirect_uri starts with: <code>https://app.example/app1/</code><a href="#appendix-A.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-8">
<pre>HTTP/1.1 303 See Other
Location: https://app.example/app1/cb
Redirect-Query: "code=SplxlOBe&amp;state=123"

</pre><a href="#appendix-A.2-8" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-9">← No parameters in URL!<a href="#appendix-A.2-9" class="pilcrow">¶</a></p>
<p id="appendix-A.2-10"><strong>Browser forwards back to Client Website:</strong>
- Current page: <code>https://as.example/consent</code>
- Redirect-Query present → Browser sets Redirect-Origin<a href="#appendix-A.2-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-11">
<pre>GET /app1/cb
Host: app.example
Redirect-Origin: "https://as.example/"
Redirect-Query: "code=SplxlOBe&amp;state=123"

</pre><a href="#appendix-A.2-11" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-12">← Clean URL
← Client verifies Redirect-Origin is <code>https://as.example/</code>
← Authorization code not in URL, history, or Referer<a href="#appendix-A.2-12" class="pilcrow">¶</a></p>
<p id="appendix-A.2-13"><strong>Benefits:</strong><a href="#appendix-A.2-13" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-A.2-14.1">Authorization code never appears in URLs<a href="#appendix-A.2-14.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-A.2-14.2">Mutual origin authentication (browser-verified)<a href="#appendix-A.2-14.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-A.2-14.3">Backward compatible (browsers/servers without support fall back to URL parameters)<a href="#appendix-A.2-14.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-A.2-15"><strong>Requirements:</strong><a href="#appendix-A.2-15" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-A.2-16.1">If Redirect-Query received in request: AS MUST use Redirect-Query for response<a href="#appendix-A.2-16.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-A.2-16.2">Client MUST verify Redirect-Origin matches expected AS<a href="#appendix-A.2-16.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-A.2-16.3">AS MUST verify Redirect-Origin matches expected client<a href="#appendix-A.2-16.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-A.2-16.4">When Redirect-Query is present, client MUST ignore URL parameters and use only header parameters<a href="#appendix-A.2-16.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">The authors would like to thank early reviewers for their valuable feedback and insights that helped shape this proposal: Jonas Primbs, Warren Parad.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dick Hardt</span></div>
<div dir="auto" class="left"><span class="org">Hellō</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dick.hardt@hello.coop" class="email">dick.hardt@hello.coop</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Sam Goto</span></div>
<div dir="auto" class="left"><span class="org">Google</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:goto@google.com" class="email">goto@google.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
